- content_for :head do
  = stylesheet_link_tag 'twit_styles'

- if !logged_in? && @station_obj
  - content_for :head do
    %script
      = "station_obj = {type:'99',station_url:'/radio/#{@station_obj.id}.xml',idpl:'#{@station_obj.id}',nom:'#{@station_obj.name}'};"

#content
  .logo
    = link_to image_tag("/images/follow_me.png"), "http://www.twitter.com/twitstation", {:target => "_new"}
    %h1
      %a{ :href => "http://www.twitter.com/twitstation" }
        Twitstation

  -if params[:queue] == "true"
    - queue = "&QUEUE=#{params[:station_id]}"
  :javascript
    $(document).ready(function() {
      var artistSearch = $("input[name='station_name']");
      
      checkForEnter = function(e) { if ((e.which || e.keyCode) == 13) { e.preventDefault(); return false; } }      
      if ($.browser.mozilla) { 
        artistSearch.keypress(checkForEnter); 
      } else {
        artistSearch.keydown(checkForEnter);
      }      
      
      artistSearch.autocomplete("/stations.js",{
        formatItem: function(item) {
          return item.name;
        },
        selectFirst: false,
        mustMatch: true,
        scrollHeight: 200,
        parse: function(data) {
          var rows = new Array();
          for(var i=0; i<data.length; i++){
            rows[i] = { data:data[i], value:data[i].name, result:data[i].name };
          }
          return rows;
        },        
        dataType: 'json'
      }).result(function(event, item) {
        $('#create_station_form form').submit();
      });
    })
  #create_station_form
    - form_for :station, :url => search_radio_path do |f|
      = f.label :artist, t('radio.create_new_station')
      = f.text_field :artist, :name => :station_name
      = f.submit t("actions.create_station"), :type => :submit, :class => 'submit_button'            

  :javascript
    var flashvars = {
      LOGGEDIN:"#{logged_in?}",
      QUEUE:"#{params[:station_id]}",
      LOCALE:"#{current_site.default_locale}"
    };
    var params = {wmode:"transparent"};
    var attributes = {id:"radio_engine", name:"radio_engine"};
    swfobject.embedSWF("flash/radio_engine.swf", "radio_player", "613", "309", "9", false, flashvars, params, attributes);

  #radio_player

  .artist_radio_info
    = render :partial => "default_artist_info"
