<% content_for :javascript do %>

var uploadInfo = function(){
  $('#avatar_upload_info').text($(this).val());
}

var addWebSite = function() {
  var value = $(this).val().replace('http://', '');
  $('#websites_clearer').before('<div class="website_row">' + 
   '<input id="user_websites_" name="user[websites][]" type="hidden" value="' + value + '" />' +
   '<b><big><a href="http://' + value + '">' + value + '</a></big> &nbsp; ' +
   '<a href="#" class="black delete_site">[ DELETE ]</a></b><br/></div>');
  $('.delete_site').click(deleteWebSite);
  $(this).val('');
}

var deleteWebSite = function() {
  $(this).closest('.website_row').remove();
  return false;
}

$(document).ready(function(){
  $('#user_avatar').focus(uploadInfo);
  $('#user_avatar').change(uploadInfo);
  $('#add_website').bind('keydown', 'return', addWebSite);
  $('.delete_site').click(deleteWebSite);
});

<% end %>

<div class="accordion_title expanded">BASIC INFO</div>
<div class="accordion_box expanded">
  <% form_for @user, :html => { :method => :put, :multipart => true, :class => "account_settings", :id => 'basic_info_form' }, :url => my_settings_path do |f| %>
    <div class="form_row">
      <label><b>Name</b></label>
      <div class="grey_round_box left_side">
        <%= f.text_field :name, :class => 'input full_width2' %>
      </div>
      <br class="clearer" />
    </div><!--/end form_row -->

    <div class="form_row">
      <div class="left_s">
        <label><b>Email</b></label>
        <div class="grey_round_box">
          <%= f.text_field :email, :class => 'input half_width2' %>
        </div>
      </div>
      <div class="right_s">
        <label><b>Profile URL</b></label>
        <div class="grey_round_box align_right">
            <span class="grey"><small>http://www.cyloop.com/</small></span>
            <%= f.text_field :slug, :class => 'input half_width' %>
        </div>
      </div>
      <br class="clearer" />
    </div><!--/end form_row -->

    <div class="form_row">
      <div class="left_side">
        <label><b>Gender</b></label>
        <div class="grey_round_box">
          <%= f.select :gender, [['Male', 'Male'], ['Female', 'Female']] %>
        </div>
      </div>
      <div class="left_side">
        <label><b>Date of Birth</b></label>
        <div class="grey_round_box">
          <%= f.date_select :born_on, :use_month_numbers => true, :from_year => 1900, :end_year => Time.now.year %>
        </div>
      </div>
      <div class="right_s">
        <label><b>Location</b></label>
        <div class="grey_round_box">
          <%= f.text_field :city_name, :class => 'input half_width3' %>
        </div>
      </div>
      <div class="clearer"></div>
    </div><!--/end form_row -->

    <div class="form_row">
      <label><b>Websites</b></label>
      <div class="grey_round_box left_side">
        <input type="text" id="add_website" class="input full_width" />
      </div>
      <br class="clearer" />
      <div id="websites">
      <% @user.websites.each_with_index do |site, index| %>
        <div class="website_row">
          <%= hidden_field_tag "user[websites][]", h(site) %>
          <b>
            <big><a href="http://<%= site %>"><%= site %></a></big> &nbsp; 
            <a href="#" class="black delete_site">[ DELETE ]</a>
          </b>
        </div>
      <% end %>
      <br class="clearer" id="websites_clearer" />
      </div>
    </div><!--/end form_row -->

    <div class="form_row">
      <div id="avatar_image">
        <%= avatar_for(profile_account, :small) %>
      </div> 
      <div class="add_update">
        <label class='label_holder'>
          <a href="#" id="avatar_upload_button" class="blue_button"><span><span>ADD / UPDATE</span></span></a>
          <%= f.file_field :avatar, :class => 'file' %>
        </label>
        <div id="avatar_upload_info"></div>
      </div>
      <div id="avatar_delete">
        <b><a href="/my/settings/remove_avatar" class="black">[ DELETE ]</a></b>
      </div>
      <div class="right_side maintain_private">
        <div class="grey_round_box">
          <%= f.check_box :private_profile %> <span>Maintain your profile private</span>
        </div>
      </div>
      <div class="clearer"></div>
    </div><!--/end form_row -->

    <div class="form_row last">
      <div class="align_right right_side">
        <a href="#" class="cancel_button">Cancel</a>
        <a href="#" class="blue_button" onclick="$(this).closest('form').submit();"><span><span>SAVE</span></span></a>
      </div>

      <br class="clearer" />
    </div><!--/end form_row -->
  <% end %><!--/end account_settings -->
</div><!--/end accordion_box -->
